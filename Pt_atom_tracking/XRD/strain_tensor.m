clearvars;
n = 18;
center = [0.5 0.5;0.5 0.5]*1001;

% k-point in CFG file, x-y inverted
k_l = cell(18);         % k-points for the left grain
k_r = cell(18);         % k-points for the right grain

k_l{1} = [
    808.988 508.007;
    650     296.003];
k_r{1} = [
    791.018 404.999;
    570.058 256.006];

k_l{2} = [
    808.996 508.992;
    650.014 297.015];
k_r{2} = [
    792.004 404;
    571     258;];

k_l{3} = [
    809.033 509.008;
    650.069 296.007];
k_r{3} = [
    791.042 403.017;
    570.957 256.991;];

k_l{4} = [
    808.998 508.021;
    650.018 296.017;];
k_r{4} = [
    790.997 402.014;
    570.005 256.993;];

k_l{5} = [
    808.964 508.024;
    649.999 296.992;];
k_r{5} = [
    791.032 404.018;
    570.974 257.997;];

k_l{6} = [
    809.074 509.009;
    651.039 296.989;];
k_r{6} = [
    790.986 409.007;
    572.003 258.009;];

k_l{7} = [
    808.983 509.013;
    650.958 296.015;];
k_r{7} = [
    791     408.994;
    572.028 257.992;];

k_l{8} = [
    808.101 511.003;
    650.923 296.986;];
k_r{8} = [
    790.975 409.996;
    572.963 257.014;];

k_l{9} = [
    808.959 509.019;
    650.959 297.004;];
k_r{9} = [
    789.062 411.006;
    572.006 258.995;];

k_l{10} = [
    808.99 509.999;
    650.099 296.008];
k_r{10} = [
    791.004 410.008;
    572.97 257.99;];

k_l{11} = [
    808.937 511.003;
    650.935 298.002;];
k_r{11} = [
    790.972 410.991;
    572.984 258.01;];

k_l{12} = [
    809.044 510.999;
    650.981 297.013;];
k_r{12} = [
    790.981 410.004;
    573.944 257.017;];

k_l{13} = [
    809.013 509.997;
    650.942 297.018;];
k_r{13} = [
    791.008 412;
    573.993 258.992;];

k_l{14} = [
    808.954 509;
    650.094 297.007;];
k_r{14} = [
    790.998 410.993;
    573.058 258.995;];

k_l{15} = [
    808.984 509.006;
    650.969 296.981;];
k_r{15} = [
    790.987 410.003;
    573.047 259.007;];

k_l{16} = [
    809.011 509.011;
    651.051 296.979;];
k_r{16} = [
    790.042 413.009;
    574.035 258.01;];

k_l{17} = [
    810.084 514.003;
    652.929 299.006;];
k_r{17} = [
    790.02 414.993;
    573.989 259.991;];

k_l{18} = [
    809.974 513.004;
    652.041 299;];
k_r{18} = [
    790.06 413.006;
    572.994 259.013;];

exx_l = zeros(n,1);
exx_r = zeros(n,1);
eyy_l = zeros(n,1);
eyy_r = zeros(n,1);
exy_l = zeros(n,1);
exy_r = zeros(n,1);

for i=2:n
    F_l = (k_l{1}-center)*inv(k_l{i}-center);
    F_r = (k_r{1}-center)*inv(k_r{i}-center);
    
    E_l = 0.5*(F_l'*F_l-eye(2));
    E_r = 0.5*(F_r'*F_r-eye(2));
    
    exx_l(i) = E_l(2,2)*100;
    exx_r(i) = E_r(2,2)*100;
    
    eyy_l(i) = E_l(1,1)*100;
    eyy_r(i) = E_r(1,1)*100;
    
    exy_l(i) = E_l(1,2)*100;
    exy_r(i) = E_r(1,2)*100;
end
t = 0:(n-1);

% plot(t,exx_r,'o-',t,exy_r,'o-',t,eyy_r,'o-','LineWidth',2);
% title('Strain of the Right Grain');

plot(t,exx_l,'o-',t,exy_l,'o-',t,eyy_l,'o-','LineWidth',2);
title('Strain of the Left Grain');

legend('\epsilon_{xx}','\epsilon_{xy}','\epsilon_{yy}','Location','northwest');
set(gca,'FontSize',15);
xlabel('ID of photo');
ylabel('Strain (%)');
xlim([0,n-1]);
ylim([-1.5,2.5]);